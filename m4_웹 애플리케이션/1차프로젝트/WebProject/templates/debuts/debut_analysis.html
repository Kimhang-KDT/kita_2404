{% extends "base.html" %}

{% block title %}
대시보드 및 개요
{% endblock %}

{% block content %}
<div class="container mt-3">
  <div class="row justify-content-center">
    <div class="col-lg-12">
      <div class="card-body">

        <!-- Overview Section -->
        <div class="card mt-2">
          <div class="card-header">
            <h5>!나만의 IP를 구축하고 성공적 데뷔!</h5>
          </div>
          <div class="card-body">
            <p><strong>분석 목적:</strong> 선택하신 장르 및 키워드와 연관된 작품 리스트(이하 그룹이라 명명)를 분석하여, 전체 시장 트렌드 대비 유의미한 성과 달성 여부 및 세부 디렉팅을 제공합니다.</p>
            <p><strong>분석 내용:</strong> 그룹 데이터 요약, 유저가 선택한 키워드(이하 키워드)의 장르 전체 키워드 데이터 대비 순위 및 비중, 전체 작품 평균 수입 대비 그룹의 평균 수익 및 중앙값 비교, 밀리언셀러 작품 존재 여부 및 세부 분석 제공</p>
            <p><strong>기대 효과:</strong> 웹소설 시장의 트렌드와 성과를 분석하여 대중의 니즈를 파악하고, 정형화 된 웹소설 IP 소싱을 벗어나 유니크한 방향성을 탐색합니다.</p>
          </div>
        </div>

        <!-- Traffic Sources Section -->
        <div class="row mt-4">
          <div class="col-md-6">
            <div class="card">
              <div class="card-header">
                <h5>키워드 [ {{ data.user_data.keywords }} ] 비중</h5>
              </div>
              <div class="card-body">
                <input type="hidden" id="keywords_importance" value='{{ data.keywords_importance | tojson }}'>
                <div class="card-body"><canvas id="keywordsPieChart" width="120%" height="80%"></canvas></div>
              </div>
              <div class="card-footer small text-muted text-center">{{ data.user_data.genre_name }} 키워드 비중</div>
            </div>
          </div>
          
          <!-- New Subscribers Section -->
          <div class="col-md-6">
            <div class="card">
              <div class="card-header">
                <h5>키워드 [ {{ data.user_data.keywords }} ] 순위</h5>
              </div>
              <div class="card-body">
                <canvas id="keywordsRankLineChart" width="120%" height="83%"></canvas>
                <input type="hidden" id="keywords_rank" value='{{ data.keywords_rank | tojson }}'>
                <input type="hidden" id="selected_keywords" value='{{ data.user_data.keywords | tojson }}'>
              </div>
              <div class="card-footer small text-muted text-center">{{ data.user_data.genre_name }} 키워드 순위</div>
            </div>
          </div>
        </div>

        <!-- Conversion, Amp, & Applause Section -->
        <div class="card mt-4">
          <div class="card-header">
            <h5>전환율, 증폭률 및 박수율 3개월 추세</h5>
          </div>
          <div class="card-body">
            <canvas id="conversionChart" width="100%" height="50"></canvas>
          </div>
          <div class="card-footer small text-muted text-center">출처: kaushik.net, Facebook, Twitter</div>
        </div>

        <!-- Recommendation Likelihood Section -->
        <div class="card mt-4">
          <div class="card-header">
            <h5>친구나 동료에게 이 블로그를 추천할 가능성은 얼마나 됩니까?</h5>
          </div>
          <div class="card-body">
            <canvas id="recommendationChart" width="100%" height="50"></canvas>
          </div>
          <div class="card-footer small text-muted text-center">출처: qualaroo.com</div>
        </div>

        <!-- Goal Conversion Trend Section -->
        <div class="card mt-4">
          <div class="card-header">
            <h5>목표 전환 추세</h5>
          </div>
          <div class="card-body">
            <canvas id="goalConversionChart" width="100%" height="50"></canvas>
          </div>
          <div class="card-footer small text-muted text-center">출처: Google Analytics</div>
        </div>

        <!-- Web Traffic Share Trend Section -->
        <div class="card mt-4">
          <div class="card-header">
            <h5>지난 12개월 동안의 웹 트래픽 공유 추세</h5>
          </div>
          <div class="card-body">
            <canvas id="webTrafficChart" width="100%" height="50"></canvas>
          </div>
          <div class="card-footer small text-muted text-center">출처: compete.com</div>
        </div>

        {% if data.novels %}
        <!-- Novels Section -->
          <div class="row card mt-4">
            <div class="card-body">
              <div class="table-responsive">
                <table class="table table-striped">
                  <tbody>
                    {% for novel in data.novels%}
                    <tr>
                      <td>
                        <img src="{{ novel.src }}" class="img-thumbnail" style="max-width: 50px;">
                      </td>
                      <td>{{ novel.title }}</td>
                      <td>{{ novel.author }}</td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </div>
            </div>
            <div class="card-footer">
              <input type="submit" class="btn float-end" value="상세 분석으로 이동" />
            </div>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
<script>
  var ctx1 = document.getElementById('trafficSourcesChart').getContext('2d');
  var trafficSourcesChart = new Chart(ctx1, {
    type: 'pie',
    data: {
      labels: ['검색', '추천', '직접', '캠페인'],
      datasets: [{
        data: [79446, 19939, 20639, 7256],
        backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0']
      }]
    },
    options: {
      responsive: true
    }
  });

  var ctx2 = document.getElementById('newSubscribersChart').getContext('2d');
  var newSubscribersChart = new Chart(ctx2, {
    type: 'bar',
    data: {
      labels: ['2011년 8월', '2012년 6월', '2012년 7월', '2012년 8월'],
      datasets: [{
        label: '구독자 수',
        data: [140, 148, 126, 171],
        backgroundColor: '#36A2EB'
      }]
    },
    options: {
      responsive: true
    }
  });

  var ctx3 = document.getElementById('conversionChart').getContext('2d');
  var conversionChart = new Chart(ctx3, {
    type: 'bar',
    data: {
      labels: ['2012년 6월', '2012년 7월', '2012년 8월'],
      datasets: [{
        label: '전환율',
        data: [150, 200, 300],
        backgroundColor: '#FF6384'
      }, {
        label: '증폭률',
        data: [400, 600, 700],
        backgroundColor: '#36A2EB'
      }, {
        label: '박수율',
        data: [500, 700, 800],
        backgroundColor: '#FFCE56'
      }]
    },
    options: {
      responsive: true
    }
  });

  var ctx4 = document.getElementById('recommendationChart').getContext('2d');
  var recommendationChart = new Chart(ctx4, {
    type: 'bar',
    data: {
      labels: ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10'],
      datasets: [{
        label: '추천 가능성',
        data: [0, 0, 0, 0, 0, 5, 10, 15, 20, 25, 30],
        backgroundColor: '#FF6384'
      }]
    },
    options: {
      responsive: true
    }
  });

  var ctx5 = document.getElementById('goalConversionChart').getContext('2d');
  var goalConversionChart = new Chart(ctx5, {
    type: 'bar',
    data: {
      labels: ['2011년 8월', '2012년 8월', '2012년 7월', '2012년 8월'],
      datasets: [{
        label: '소개',
        data: [1501, 2277, 1501, 2371],
        backgroundColor: '#FF6384'
      }, {
        label: '강연',
        data: [809, 701, 664, 692],
        backgroundColor: '#36A2EB'
      }, {
        label: '구독자',
        data: [140, 148, 171, 169],
        backgroundColor: '#FFCE56'
      }, {
        label: '목적',
        data: [324, 180, 324, 269],
        backgroundColor: '#4BC0C0'
      }, {
        label: '분석 2',
        data: [395, 180, 180, 269],
        backgroundColor: '#9966FF'
      }]
    },
    options: {
      responsive: true
    }
  });

  var ctx6 = document.getElementById('webTrafficChart').getContext('2d');
  var webTrafficChart = new Chart(ctx6, {
    type: 'line',
    data: {
      labels: ['2011년 8월', '2011년 9월', '2011년 10월', '2011년 11월', '2011년 12월', '2012년 1월', '2012년 2월', '2012년 3월', '2012년 4월', '2012년 5월', '2012년 6월', '2012년 7월', '2012년 8월'],
      datasets: [{
        label: 'kaushik.net',
        data: [20000, 21000, 18000, 22000, 20000, 21000, 22000, 23000, 24000, 23000, 21000, 22000, 25000],
        borderColor: '#FF6384',
        fill: false
      }, {
        label: 'lunametrics.com/blog',
        data: [18000, 17000, 16000, 19000, 18000, 17000, 18000, 20000, 21000, 20000, 19000, 20000, 21000],
        borderColor: '#36A2EB',
        fill: false
      }, {
        label: 'roi-revolution.com/blog',
        data: [15000, 16000, 14000, 16000, 15000, 14000, 15000, 16000, 17000, 16000, 15000, 16000, 17000],
        borderColor: '#FFCE56',
        fill: false
      }]
    },
    options: {
      responsive: true
    }
  });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
<script src="{{ url_for('static', filename='assets/demo/keywords-important-pie.js') }}"></script>
<script src="{{ url_for('static', filename='assets/demo/keywords-rank-line-chart.js') }}"></script>
{% endblock %}
